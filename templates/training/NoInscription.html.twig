{% extends 'base.html.twig' %}

{% block body %}
    {{ parent() }}

    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>{{ formation.titre }}</title>
        <!-- Add your additional meta tags, stylesheets, and other head elements here -->
    </head>
    <body>

        <div class="container mt-5">
            <div class="row">
                <div class="col-md-8 mx-auto">
                    <h1>{{ formation.titre }}</h1>
                    <p>{{ formation.description }}</p>

                    {% if formation.video is not null %}
                        <div style="border-radius: 25px; overflow: hidden; position: relative;">
                            <video width="100%" height="200" muted>
                                {% set videoPath = formation.video starts with 'file:/' ? asset('uploads/' ~ formation.video|split('/')|last) : asset('uploads/' ~ formation.video) %}
                                <source src="{{ videoPath }}" type="video/mp4">
                                Your browser does not support the video tag.
                            </video>
                            <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; justify-content: center; align-items: center; background: rgba(0, 0, 0, 0.4);">
                                <p style="color: white; font-size: 18px; font-weight: bold;">Inscription Required</p>
                            </div>
                        </div>
                    {% else %}
                        <div class="card-img-top text-center pt-4">
                            No Video
                        </div>
                    {% endif %}
                </div>
            </div>

            <div class="row mt-5">
                <div class="col-md-8 mx-auto">
                    {% if commentaires is not empty %}
                        <h2>Commentaires</h2>
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Texte</th>
                                    <th>Date</th>
                                    <th>Ã‰valuation</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for comment in commentaires %}
                                    <tr>
                                        <td>{{ comment.text }}</td>
                                        <td>{{ comment.date|date('Y-m-d H:i:s') }}</td>
                                        <td>{{ comment.evaluation }}</td>
                                        <td>
                                            <a href="{{ path('NO_delete_commentaire', {'id': comment.id, 'idFormation': formation.id}) }}" class="btn btn-danger btn-sm" onclick="return confirm('Are you sure you want to delete this comment?');">
                                                <i class="fas fa-trash"></i>
                                            </a>
                                            <a href="{{ path('NO_edit_commentaire', {'id': comment.id, 'idFormation': formation.id}) }}" class="btn btn-primary btn-sm">
                                                <i class="fas fa-edit"></i>
                                            </a>
                                        </td>
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    {% else %}
                        <p>No comments.</p>
                    {% endif %}
                </div>
            </div>

            <div class="row mt-5">
                <div class="col-md-8 mx-auto">
                    <h2>Add a comment</h2>
                    <form id="comment-form" method="post" action="{{ path('checkTraining', {'idFormation': formation.id}) }}">
                        <div class="form-group row">
                            <div class="col-md-6">
                                <label for="comment_text">Comment</label>
                                <textarea class="form-control" rows="8" placeholder="Saisissez votre commentaire ici..." id="comment_text" name="comment_text"></textarea>
                            </div>

                            <div class="col-md-1">
                                <label for="evaluation">Evaluation</label>
                                
                                <select class="form-control" id="evaluation" name="evaluation">
                                    {% for i in 1..5 %}
                                        <option value="{{ i }}">{{ i }}</option>
                                    {% endfor %}
                                </select>
                                 <div class="container mt-5">
            <div class="fb-share-button" data-href="https://beanmate.my.canva.site/ecoartformation" data-layout="button_count" data-size="small">
                <a target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://beanmate.my.canva.site/ecoartformation" class="fb-xfbml-parse-ignore">Share</a>
            </div>
        </div>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary">Comment</button>
                    </form>
                    
                </div>
            </div>

        </div>

        <!-- Facebook SDK script -->
        <script async defer crossorigin="anonymous" src="https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v13.0&appId=788068436664746&autoLogAppEvents=1" nonce="none"></script>

        <!-- Facebook Share Button -->
       

        <!-- Your additional scripts or inline scripts here -->

    </body>
    </html>
{% endblock %}
