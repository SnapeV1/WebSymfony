{% extends 'base.html.twig' %}

{% block body %}
    {{ parent() }}

    <div style="margin-top: 50px;">
        <h1 style="text-align: center; color= "#C87A19";">List of Groups</h1>
        {% if groups is empty %}
            <p style="text-align: center;">Maybe create a group?</p>
        {% else %}
            <table style="border-collapse: collapse; width: 80%; margin: 0 auto; margin-top: 20px;">
                <thead style="background-color: #f2f2f2*;">
                    <tr>
                        <th style="padding: 10px;">Group Name</th>
                        <th style="padding: 10px;">Size</th>
                        <th style="padding: 10px;">Logo</th>
                        <th style="padding: 10px;"></th>
                    </tr>
                </thead>
                <tbody>
                    {% for group in groups %}
                        <tr style="border-bottom: 1px solid #ccc;">
                           <td style="padding: 10px;">
    <a href="{{ path('members_getall', {'id': group.id, 'userid': userid}) }}" style="text-decoration: none; color: bleu ; transition: color 0.3s;">
        {{ group.nom }}
    </a>
</td>
                            <td style="padding: 10px;">{{ group.size }}</td>
                            <td style="padding: 10px;">
                                <img src="{{ group.logo starts with 'C:\\' ? asset('uploads/' ~ group.logo|split('\\')|last) : asset(group.logo) }}" alt="Group Logo" style="width: 100px; height: auto; border-radius: 5px; box-shadow: 0 0 10px 0 rgba(0,0,0,0.1);">
                            </td>
                            <td style="padding: 10px;">
                                <a href="#" onclick="return editGroup({{ group.id }})"  padding: 5px 10px; border-radius: 5px; ">
                                    <i class="fas fa-edit"></i>
                                </a>
                                <a href="#" onclick="return confirmDelete({{ group.id }})" padding: 5px 10px; border-radius: 5px;">
                                    <i class="fas fa-trash-alt"></i>
                                </a>
                            </td>
                        </tr>

                        <tr id="editForm_{{ group.id }}" style="display: none;">
                            <td colspan="4" style="padding: 10px;">
                                <form action="{{ path('update_group', {'id': group.id, 'userid': userid}) }}" method="POST" enctype="multipart/form-data">
                                    <input type="text" name="group_name" value="{{ group.nom }}" />
                                    
        <div class="d-flex justify-content-end mt-3">
                                    <button type="submit" class="btn btn-primary">
                                        <i class="fas fa-save"></i> Save
                                    </button>
                                    </div>
                                </form>
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        {% endif %}
    </div>
    
    <div style="text-align: center; margin-top: 20px;">
        <a href="{{ path('addgroup', {'userid': userid}) }}"class="btn btn-primary" style="text-decoration: none; padding: 5px 10px; border-radius: 5px; color: white;">
            <i class="fas fa-plus"></i> Add Group
        </a>
    </div>

    <script>
        function confirmDelete(groupId) {
            if (confirm("Are you sure you want to delete this group?")) {
                window.location.href = "{{ path('deletegroup', {'id': 'GROUP_ID', 'userid': 'USER_ID'}) }}".replace('GROUP_ID', groupId).replace('USER_ID', {{ userid }});
            }
            return false;
        }

        function editGroup(groupId) {
            var editForm = document.getElementById("editForm_" + groupId);

            if (editForm) {
                editForm.style.display = "table-row"; // Display the edit form
            }

            return false;
        }
    </script>
    <style>
      .template-color {
        color: bleu; /* Replace with your desired color code */
    }
    </style>

{% endblock %}
